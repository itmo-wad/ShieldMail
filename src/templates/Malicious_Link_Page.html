<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/Malicious_Link_Page.css" />
    <title>ShieldMail Link Checker</title>
</head>
<body>

    <div class="navbar">
        <a href="#" style="font-weight: bold;">ShieldMail</a>
        <a href="{{ url_for('core.dashboard') }}">Dashboard</a>
        <a href="{{ url_for('auth.logout') }}">Logout</a>
    </div>

    <div class="container">
        <div class="main-content">
            <h1>Link Checker: Secure Your Browsing!</h1>
            <p>Enter any link below to check its safety. Our system will analyze it to detect potential security threats. Don't let phishing attempts compromise your security!</p>

            <div class="link-checker-section">
                <h2>How Our Link Checker Works:</h2>
                <p>When you submit a link, our system:</p>
                <ul>
                    <li>Checks the URL against a database of known phishing sites.</li>
                    <li>Analyzes the content for suspicious scripts and tokens.</li>
                    <li>Provides a report on the link's reliability and security.</li>
                </ul>
                <p>Protect your personal data and browse the internet with confidence.</p>

                <label for="linkInput">Enter Link to Check:</label>
                <input type="url" id="linkInput" placeholder="Enter link here" required class="link-input">
                <button class="cta-button" onclick="checkForMaliciousLink()">Analyze Link</button>

                <div id="linkResults"></div>
            </div>

            <div class="user-reviews-section">
                <h2>What Our Users Say:</h2>
                <blockquote>"ShieldMail's Link Checker has been a game-changer for my online safety. I can now click on links without worry!" - Alex</blockquote>
                <blockquote>"The detailed reports provided after each scan really help me understand the threats out there." - Sam</blockquote>
            </div>
        </div>
    </div>

    <script>
        function displayLinkResult(isMalicious) {
            var resultsDiv = document.getElementById('linkResults');
            resultsDiv.className = isMalicious ? 'result-message is-malicious' : 'result-message not-malicious';
            var resultMessage = isMalicious ? "Warning: This link is considered dangerous!" : "This link is considered safe.";
            resultsDiv.innerHTML = `<p>${resultMessage}</p>`;
            resultsDiv.style.display = 'block';
            resultsDiv.style.opacity = 0;
            animateElement(resultsDiv, 'fadeIn', '0.5s', '0s');
        }

        function hideLinkResult() {
            var resultsDiv = document.getElementById('linkResults');
            animateElement(resultsDiv, 'fadeOut', '0.5s', '0s');
            setTimeout(function() {
                resultsDiv.style.display = 'none';
            }, 500); // Ensure this matches the duration of the fadeOut animation
        }

        function checkForMaliciousLink() {
            hideLinkResult();
            var link = document.getElementById('linkInput').value;

            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/maliciouslinkcheck', true); // Update this URL to where you want to send the POST request
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');

            xhr.onload = function() {
                if (xhr.status >= 200 && xhr.status < 300) {
                    var response = JSON.parse(xhr.responseText);
                    displayLinkResult(response.isMalicious);
                } else {
                    console.error('Request failed with status:', xhr.status);
                }
            };

            var data = JSON.stringify({ link: link });
            xhr.send(data);
        }

        function animateElement(element, animationName, duration, delay) {
            element.style.animationName = animationName;
            element.style.animationDuration = duration;
            element.style.animationDelay = delay;
            element.style.animationFillMode = 'forwards';
        }
    </script>

</body>
</html>